stat_summary(aes(shape="League average"),
fun = 'mean',
geom =c("line"),
color = "#00688b",
show.legend = TRUE) +
annotate("text", x = 2010, y = 8.7,
label = "2012\nLeague average",
fontface = 2,
size = 4) +
annotate("text", x = 2010, y = 8,
label = "7.5",
fontface = 2,
color = "#00688b",
size = 6) +
annotate("text", x = 1924, y = 1.5,
label = "League average\n1924",
fontface = 2,
size = 4) +
annotate("text", x = 1924, y = 2.2,
label = "2.7",
fontface = 2,
color = "#00688b",
size = 6) +
annotate(geom ="text", x = 1917, y = 1,
size = 3.0,
color = "#7e7e7e",
label = "U.S. enters\nWorld War I.",
hjust = 0.5) +
annotate(geom ="text", x = 1945, y = 1.5,
size = 3.0,
color = "#7e7e7e",
label = "Players return\nfrom World War II.",
hjust = 0.5) +
annotate(geom ="text", x = 1963, y = 2.5,
size = 3.0,
color = "#7e7e7e",
label = "Strike zone enlarged\nfrom 1963-68.",
hjust = 0.5) +
annotate(geom ="text", x = 1969, y = 8.5,
size = 3.0,
color = "#7e7e7e",
label = "Pitching had become so dominant\nin the 1960s that the mound\nwas lowered in 1969.",
hjust = 0.5) +
annotate(geom ="text", x = 1972, y = 1.5,
size = 3.0,
color = "#7e7e7e",
label = "Designated hitter\nrule took effect.",
hjust = 0.5) +
annotate(geom ="text", x = 2006, y = 3.5,
size = 3.0,
color = "#7e7e7e",
label = "Mitchell report\non steroids.",
hjust = 0.5) +
annotate(geom="label", x = 1925, y = 9,
size = 3.0,
fontface = 2,
color = "#7e7e7e",
fill="#FFFFFF",
label = "(by batters)",
label.size = NA,
hjust = 1) +
annotate(geom="label", x = 1900, y = 9,
size = 3.5,
fontface = 2,
color = "#000000",
fill="#FFFFFF",
label = "Strikeouts per game per team",
label.size = NA,
hjust = -1) +
scale_x_continuous("",
breaks=c(1900,1910,1920,1930,1940,1950,1960,1970,1980,1990,2000,2010),
limits=c(1900,2015)) +
scale_y_continuous("",
breaks=c(0,1,2,3,4,5,6,7,8,9),
limits=c(0,9),
position = "right"
) +
theme_minimal() +
theme(plot.title = element_text(family = "playfair",
face = "bold",
size = 16,
color = "#000000",
margin = margin(b = 0),
vjust = 0),
plot.subtitle = element_text(family = "playfair",
size = 12,
color = "#000000",
margin = margin(b = 10),
vjust = -2)) +
theme(axis.text.y.right = element_text(color = "#7e7e7e",
face = "bold"),
axis.text.x = element_text(hjust = 0),
axis.line.x = element_line(),
axis.ticks.x = element_line(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(linetype = "dotted",
color = "#dfdfdf"),
panel.grid.minor = element_blank()) +
theme(legend.position = c(0, 0.9),
legend.background = element_rect(fill="#FFFFFF",
color=NA),
legend.justification='left',
legend.direction='horizontal',
legend.text = element_text(color = "#7e7e7e"),
legend.title = element_blank()) +
labs(title = "Strikeouts on the Rise",
subtitle = "There were more strikeouts in 2012 than at any other time in major league history."
)
ggplot(team_strikeouts,
aes(yearID, strikeouts_per_game)) +
geom_point (color="#dfdfdf") +
geom_segment(aes(x = 1917, y = 1.3, xend = 1917, yend = 3.5),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1945, y = 1.8, xend = 1945, yend = 3.9),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1963, y = 2.8, xend = 1963, yend = 5.8),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1969, y = 7.9, xend = 1969, yend = 5.8),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1972, y = 1.8, xend = 1972, yend = 5.2),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 2006, y = 3.8, xend = 2006, yend = 6.8),
color = "#dfdfdf",
size = 0.1) +
stat_summary(fun = 'mean',
geom =c("point"),
color = "#00688b") +
stat_summary(aes(shape="League average"),
fun = 'mean',
geom =c("line"),
color = "#00688b",
show.legend = TRUE) +
annotate("text", x = 2010, y = 8.7,
label = "2012\nLeague average",
fontface = 2,
size = 4) +
annotate("text", x = 2010, y = 8,
label = "7.5",
fontface = 2,
color = "#00688b",
size = 6) +
annotate("text", x = 1924, y = 1.5,
label = "League average\n1924",
fontface = 2,
size = 4) +
annotate("text", x = 1924, y = 2.2,
label = "2.7",
fontface = 2,
color = "#00688b",
size = 6) +
annotate(geom ="text", x = 1917, y = 1,
size = 3.0,
color = "#7e7e7e",
label = "U.S. enters\nWorld War I.",
hjust = 0.5) +
annotate(geom ="text", x = 1945, y = 1.5,
size = 3.0,
color = "#7e7e7e",
label = "Players return\nfrom World War II.",
hjust = 0.5) +
annotate(geom ="text", x = 1963, y = 2.5,
size = 3.0,
color = "#7e7e7e",
label = "Strike zone enlarged\nfrom 1963-68.",
hjust = 0.5) +
annotate(geom ="text", x = 1969, y = 8.5,
size = 3.0,
color = "#7e7e7e",
label = "Pitching had become so dominant\nin the 1960s that the mound\nwas lowered in 1969.",
hjust = 0.5) +
annotate(geom ="text", x = 1972, y = 1.5,
size = 3.0,
color = "#7e7e7e",
label = "Designated hitter\nrule took effect.",
hjust = 0.5) +
annotate(geom ="text", x = 2006, y = 3.5,
size = 3.0,
color = "#7e7e7e",
label = "Mitchell report\non steroids.",
hjust = 0.5) +
annotate(geom="label", x = 1925, y = 9,
size = 3.0,
fontface = 2,
color = "#7e7e7e",
fill="#FFFFFF",
label = "(by batters)",
label.size = NA,
hjust = 1) +
annotate(geom="label", x = 1900, y = 9,
size = 3.5,
fontface = 2,
color = "#000000",
fill="#FFFFFF",
label = "Strikeouts per game per team",
label.size = NA,
hjust = 1) +
scale_x_continuous("",
breaks=c(1900,1910,1920,1930,1940,1950,1960,1970,1980,1990,2000,2010),
limits=c(1900,2015)) +
scale_y_continuous("",
breaks=c(0,1,2,3,4,5,6,7,8,9),
limits=c(0,9),
position = "right"
) +
theme_minimal() +
theme(plot.title = element_text(family = "playfair",
face = "bold",
size = 16,
color = "#000000",
margin = margin(b = 0),
vjust = 0),
plot.subtitle = element_text(family = "playfair",
size = 12,
color = "#000000",
margin = margin(b = 10),
vjust = -2)) +
theme(axis.text.y.right = element_text(color = "#7e7e7e",
face = "bold"),
axis.text.x = element_text(hjust = 0),
axis.line.x = element_line(),
axis.ticks.x = element_line(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(linetype = "dotted",
color = "#dfdfdf"),
panel.grid.minor = element_blank()) +
theme(legend.position = c(0, 0.9),
legend.background = element_rect(fill="#FFFFFF",
color=NA),
legend.justification='left',
legend.direction='horizontal',
legend.text = element_text(color = "#7e7e7e"),
legend.title = element_blank()) +
labs(title = "Strikeouts on the Rise",
subtitle = "There were more strikeouts in 2012 than at any other time in major league history."
)
ggplot(team_strikeouts,
aes(yearID, strikeouts_per_game)) +
geom_point (color="#dfdfdf") +
geom_segment(aes(x = 1917, y = 1.3, xend = 1917, yend = 3.5),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1945, y = 1.8, xend = 1945, yend = 3.9),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1963, y = 2.8, xend = 1963, yend = 5.8),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1969, y = 7.9, xend = 1969, yend = 5.8),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1972, y = 1.8, xend = 1972, yend = 5.2),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 2006, y = 3.8, xend = 2006, yend = 6.8),
color = "#dfdfdf",
size = 0.1) +
stat_summary(fun = 'mean',
geom =c("point"),
color = "#00688b") +
stat_summary(aes(shape="League average"),
fun = 'mean',
geom =c("line"),
color = "#00688b",
show.legend = TRUE) +
annotate("text", x = 2010, y = 8.7,
label = "2012\nLeague average",
fontface = 2,
size = 4) +
annotate("text", x = 2010, y = 8,
label = "7.5",
fontface = 2,
color = "#00688b",
size = 6) +
annotate("text", x = 1924, y = 1.5,
label = "League average\n1924",
fontface = 2,
size = 4) +
annotate("text", x = 1924, y = 2.2,
label = "2.7",
fontface = 2,
color = "#00688b",
size = 6) +
annotate(geom ="text", x = 1917, y = 1,
size = 3.0,
color = "#7e7e7e",
label = "U.S. enters\nWorld War I.",
hjust = 0.5) +
annotate(geom ="text", x = 1945, y = 1.5,
size = 3.0,
color = "#7e7e7e",
label = "Players return\nfrom World War II.",
hjust = 0.5) +
annotate(geom ="text", x = 1963, y = 2.5,
size = 3.0,
color = "#7e7e7e",
label = "Strike zone enlarged\nfrom 1963-68.",
hjust = 0.5) +
annotate(geom ="text", x = 1969, y = 8.5,
size = 3.0,
color = "#7e7e7e",
label = "Pitching had become so dominant\nin the 1960s that the mound\nwas lowered in 1969.",
hjust = 0.5) +
annotate(geom ="text", x = 1972, y = 1.5,
size = 3.0,
color = "#7e7e7e",
label = "Designated hitter\nrule took effect.",
hjust = 0.5) +
annotate(geom ="text", x = 2006, y = 3.5,
size = 3.0,
color = "#7e7e7e",
label = "Mitchell report\non steroids.",
hjust = 0.5) +
annotate(geom="label", x = 1925, y = 9,
size = 3.0,
fontface = 2,
color = "#7e7e7e",
fill="#FFFFFF",
label = "(by batters)",
label.size = NA,
hjust = 1) +
annotate(geom="label", x = 1900, y = 9,
size = 3.5,
fontface = 2,
color = "#000000",
fill="#FFFFFF",
label = "Strikeouts per game per team",
label.size = NA,
hjust = 0.7) +
scale_x_continuous("",
breaks=c(1900,1910,1920,1930,1940,1950,1960,1970,1980,1990,2000,2010),
limits=c(1900,2015)) +
scale_y_continuous("",
breaks=c(0,1,2,3,4,5,6,7,8,9),
limits=c(0,9),
position = "right"
) +
theme_minimal() +
theme(plot.title = element_text(family = "playfair",
face = "bold",
size = 16,
color = "#000000",
margin = margin(b = 0),
vjust = 0),
plot.subtitle = element_text(family = "playfair",
size = 12,
color = "#000000",
margin = margin(b = 10),
vjust = -2)) +
theme(axis.text.y.right = element_text(color = "#7e7e7e",
face = "bold"),
axis.text.x = element_text(hjust = 0),
axis.line.x = element_line(),
axis.ticks.x = element_line(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(linetype = "dotted",
color = "#dfdfdf"),
panel.grid.minor = element_blank()) +
theme(legend.position = c(0, 0.9),
legend.background = element_rect(fill="#FFFFFF",
color=NA),
legend.justification='left',
legend.direction='horizontal',
legend.text = element_text(color = "#7e7e7e"),
legend.title = element_blank()) +
labs(title = "Strikeouts on the Rise",
subtitle = "There were more strikeouts in 2012 than at any other time in major league history."
)
ggplot(team_strikeouts,
aes(yearID, strikeouts_per_game)) +
geom_point (color="#dfdfdf") +
geom_segment(aes(x = 1917, y = 1.3, xend = 1917, yend = 3.5),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1945, y = 1.8, xend = 1945, yend = 3.9),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1963, y = 2.8, xend = 1963, yend = 5.8),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1969, y = 7.9, xend = 1969, yend = 5.8),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 1972, y = 1.8, xend = 1972, yend = 5.2),
color = "#dfdfdf",
size = 0.1) +
geom_segment(aes(x = 2006, y = 3.8, xend = 2006, yend = 6.8),
color = "#dfdfdf",
size = 0.1) +
stat_summary(fun = 'mean',
geom =c("point"),
color = "#00688b") +
stat_summary(aes(shape="League average"),
fun = 'mean',
geom =c("line"),
color = "#00688b",
show.legend = TRUE) +
annotate("text", x = 2010, y = 8.7,
label = "2012\nLeague average",
fontface = 2,
size = 4) +
annotate("text", x = 2010, y = 8,
label = "7.5",
fontface = 2,
color = "#00688b",
size = 6) +
annotate("text", x = 1924, y = 1.5,
label = "League average\n1924",
fontface = 2,
size = 4) +
annotate("text", x = 1924, y = 2.2,
label = "2.7",
fontface = 2,
color = "#00688b",
size = 6) +
annotate(geom ="text", x = 1917, y = 1,
size = 3.0,
color = "#7e7e7e",
label = "U.S. enters\nWorld War I.",
hjust = 0.5) +
annotate(geom ="text", x = 1945, y = 1.5,
size = 3.0,
color = "#7e7e7e",
label = "Players return\nfrom World War II.",
hjust = 0.5) +
annotate(geom ="text", x = 1963, y = 2.5,
size = 3.0,
color = "#7e7e7e",
label = "Strike zone enlarged\nfrom 1963-68.",
hjust = 0.5) +
annotate(geom ="text", x = 1969, y = 8.5,
size = 3.0,
color = "#7e7e7e",
label = "Pitching had become so dominant\nin the 1960s that the mound\nwas lowered in 1969.",
hjust = 0.5) +
annotate(geom ="text", x = 1972, y = 1.5,
size = 3.0,
color = "#7e7e7e",
label = "Designated hitter\nrule took effect.",
hjust = 0.5) +
annotate(geom ="text", x = 2006, y = 3.5,
size = 3.0,
color = "#7e7e7e",
label = "Mitchell report\non steroids.",
hjust = 0.5) +
annotate(geom="label", x = 1925, y = 9,
size = 3.0,
fontface = 2,
color = "#7e7e7e",
fill="#FFFFFF",
label = "(by batters)",
label.size = NA,
hjust = 1) +
annotate(geom="label", x = 1900, y = 9,
size = 3.5,
fontface = 2,
color = "#000000",
fill="#FFFFFF",
label = "Strikeouts per game per team",
label.size = NA,
hjust = 0.3) +
scale_x_continuous("",
breaks=c(1900,1910,1920,1930,1940,1950,1960,1970,1980,1990,2000,2010),
limits=c(1900,2015)) +
scale_y_continuous("",
breaks=c(0,1,2,3,4,5,6,7,8,9),
limits=c(0,9),
position = "right"
) +
theme_minimal() +
theme(plot.title = element_text(family = "playfair",
face = "bold",
size = 16,
color = "#000000",
margin = margin(b = 0),
vjust = 0),
plot.subtitle = element_text(family = "playfair",
size = 12,
color = "#000000",
margin = margin(b = 10),
vjust = -2)) +
theme(axis.text.y.right = element_text(color = "#7e7e7e",
face = "bold"),
axis.text.x = element_text(hjust = 0),
axis.line.x = element_line(),
axis.ticks.x = element_line(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(linetype = "dotted",
color = "#dfdfdf"),
panel.grid.minor = element_blank()) +
theme(legend.position = c(0, 0.9),
legend.background = element_rect(fill="#FFFFFF",
color=NA),
legend.justification='left',
legend.direction='horizontal',
legend.text = element_text(color = "#7e7e7e"),
legend.title = element_blank()) +
labs(title = "Strikeouts on the Rise",
subtitle = "There were more strikeouts in 2012 than at any other time in major league history."
)
# Pipes everwhere!
team_strikeouts <- select(Teams, yearID, name, G, SO) %>%
mutate(strikeouts_per_game = SO/G)
avg_so_by_year  <- team_strikeouts %>%
group_by(yearID) %>%
summarise(avg_so = mean(strikeouts_per_game))
blogdown::build_site()
blogdown::serve_site()
